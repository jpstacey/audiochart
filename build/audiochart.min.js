/*! AudioChart 2014-11-23 */

(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=function(){function a(a){throw this.data=a,new Error("Please use a derived class")}return a.prototype.num_series=function(){},a.prototype.series_names=function(){},a.prototype.series_min=function(){},a.prototype.series_max=function(){},a.prototype.series_value=function(){},a.prototype.series_length=function(){},a}(),d=function(a){function b(a){this.data=a}return n(b,a),b.prototype.num_series=function(){return this.data.getNumberOfColumns()-1},b.prototype.series_names=function(){var a,b,c,d;for(d=[],a=b=1,c=this.data.getNumberOfColumns()-1;c>=1?c>=b:b>=c;a=c>=1?++b:--b)d.push(this.data.getColumnLabel(a));return d},b.prototype.series_min=function(a){return this.data.getColumnRange(a+1).min},b.prototype.series_max=function(a){return this.data.getColumnRange(a+1).max},b.prototype.series_value=function(a,b){return this.data.getValue(b,a+1)},b.prototype.series_length=function(){return this.data.getNumberOfRows()},b}(b),f=function(a){function b(a){if("string"==typeof a)this.object=JSON.parse(a);else{if("object"!=typeof a)throw new Error("Please provide a JSON string or derived object.");this.object=a}}return n(b,a),b.prototype.num_series=function(){return this.object.data.length},b.prototype.series_names=function(){var a,b,c,d,e;for(d=this.object.data,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.series);return e},b.prototype.series_min=function(a){return Math.min.apply(this,this.object.data[a].values)},b.prototype.series_max=function(a){return Math.max.apply(this,this.object.data[a].values)},b.prototype.series_value=function(a,b){return this.object.data[a].values[b]},b.prototype.series_length=function(a){return this.object.data[a].values.length},b}(b),e=function(a){function b(a,b){if(this.table=a.getElementById(b),null==this.table)throw new Error('Failed to find table with id "'+b+'".')}return n(b,a),b.prototype.num_series=function(){return this.table.getElementsByTagName("tr")[0].children.length},b.prototype.series_names=function(){var a,b,c,d,e;for(d=this.table.getElementsByTagName("th"),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.textContent);return e},b.prototype._series_floats=function(){var a,b,c,d,e;for(d=this.table.getElementsByTagName("td"),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(parseFloat(a.textContent));return e},b.prototype.series_min=function(a){return Math.min.apply(this,this._series_floats(a))},b.prototype.series_max=function(a){return Math.max.apply(this,this._series_floats(a))},b.prototype.series_value=function(a,b){return parseFloat(this.table.getElementsByTagName("tr")[b+1].children[a].textContent)},b.prototype.series_length=function(){return this.table.getElementsByTagName("tr").length-1},b}(b),h=function(){function a(a,b){if(this.minimum_datum=a,this.maximum_datum=b,this.minimum_datum>this.maximum_datum)throw new Error("minimum datum should be <= maximum datum")}return a.prototype.map=function(){},a}(),c=function(a){function b(a,c,d,e){if(this.minimum_frequency=d,this.maximum_frequency=e,b.__super__.constructor.call(this,a,c),this.minimum_frequency>this.maximum_frequency)throw new Error("minimum frequency should be <= maximum frequency");this.data_range=this.maximum_datum-this.minimum_datum}return n(b,a),b.prototype.map=function(a){var b;return b=this.data_range?(a-this.minimum_datum)/this.data_range:.5,this.minimum_frequency+b*(this.maximum_frequency-this.minimum_frequency)},b}(h),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b}(h),j=function(){function a(a){this.context=a,this.oscillator=this.context.createOscillator()}return a.prototype.start=function(){this.oscillator.connect(this.context.destination),this.oscillator.start(0)},a.prototype.frequency=function(a,b){var c;c=function(b){return function(){b.oscillator.frequency.value=a}}(this),setTimeout(c,b)},a.prototype.stop=function(a){this.oscillator.stop(a)},a}(),i=function(){function a(a,b,c,d){this.data=a,this.pitch_mapper=b,this.sounder=c,this.visual_callback=null!=d?d:null,this.interval=5e3/this.data.series_length(0)}return a.prototype.play=function(){var a,b,c,d,e;for(c=this.data.series_length(0),d=c-1,this.sounder.start(0),null!=this.visual_callback&&this.visual_callback(0,0),this.sounder.frequency(this.pitch_mapper.map(this.data.series_value(0,0))),a=e=1;d>=1?d>=e:e>=d;a=d>=1?++e:--e)b=this.interval*a,null!=this.visual_callback&&this._highlight_enqueue(0,a,b),this.sounder.frequency(this.pitch_mapper.map(this.data.series_value(0,a)),b);this.sounder.stop(c*this.interval/1e3)},a.prototype._highlight_enqueue=function(a,b,c){var d;d=function(c){return function(){c.visual_callback(a,b)}}(this),setTimeout(d,c)},a}(),a=function(){function a(a){var b,g,h,m,n,o,p,q;if(n="Sorry, it seems your browser doesn't support the Web Audio API.",g=k(),null==g)throw alert(n),new Error(n);switch(m="Invalid data type '"+a.type+"' given.",h=null,b=null,a.type){case"google":h=new d(a.data),null!=a.chart&&(b=l(a.chart));break;case"json":h=new f(a.data);break;case"html_table":h=new e(a.html_document,a.html_table_id);break;default:throw alert(m),new Error(m)}o=new c(h.series_min(0),h.series_max(0),a.frequency_low,a.frequency_high),q=new j(g),p=new i(h,o,q,b),p.play()}return a}(),k=function(){return"undefined"!=typeof AudioContext&&null!==AudioContext?new AudioContext:"undefined"!=typeof webkitAudioContext&&null!==webkitAudioContext?new webkitAudioContext:null},l=function(a){return function(b,c){a.setSelection([{row:c,column:b+1}])}},"undefined"!=typeof exports&&null!==exports?(exports.AudioChart=a,exports.DataWrapper=b,exports.GoogleDataWrapper=d,exports.JSONDataWrapper=f,exports.HTMLTableDataWrapper=e,exports.PitchMapper=h,exports.FrequencyPitchMapper=c,exports.NotePitchMapper=g,exports.WebAudioSounder=j,exports.Player=i,exports._google_visual_callback_maker=l):(this.AudioChart=a,this.DataWrapper=b,this.GoogleDataWrapper=d,this.JSONDataWrapper=f,this.HTMLTableDataWrapper=e,this.PitchMapper=h,this.FrequencyPitchMapper=c,this.NotePitchMapper=g,this.WebAudioSounder=j,this.Player=i,this._google_visual_callback_maker=l)}).call(this);
//# sourceMappingURL=audiochart.min.js.map